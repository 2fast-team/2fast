<Page
    x:Class="Project2FA.Uno.Views.NewDataFilePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Project2FA.Uno.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ctwc="using:CommunityToolkit.WinUI.Controls"
    xmlns:lottie="using:CommunityToolkit.WinUI.Lottie"
    xmlns:utu="using:Uno.Toolkit.UI"
    xmlns:strings="using:Project2FA.Strings"
    xmlns:not_win="http://uno.ui/not_win"
    xmlns:extensions="using:Project2FA.Extensions"
    mc:Ignorable="d not_win"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        <utu:NavigationBar 
            Grid.Row="0"
            utu:SafeArea.Insets="Top"
            Foreground="{ThemeResource SystemControlForegroundBaseHighBrush}"
            Background="{ThemeResource TwoFABackgroundBrush}">
            <utu:NavigationBar.Content>
                <TextBlock 
                    VerticalAlignment="Center"
                    Text="~NewDataFilePageTitle.Text"
                    x:Uid="NewDataFilePageTitle"
                    Style="{StaticResource ShellHeaderTitleTextBlockStyle}" />
            </utu:NavigationBar.Content>
        </utu:NavigationBar>
        

            <!--for debug-->
        <Border 
            x:Name="PageStaticBackgroundBorder" 
            Grid.Row="1"
            Visibility="Collapsed">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="Red" Offset="0.000" />
                    <GradientStop Color="Red" Offset="0.166" />
                    <GradientStop Color="DarkOrange" Offset="0.167" />
                    <GradientStop Color="DarkOrange" Offset="0.332" />
                    <GradientStop Color="Goldenrod" Offset="0.333" />
                    <GradientStop Color="Goldenrod" Offset="0.499" />
                    <GradientStop Color="SeaGreen" Offset="0.500" />
                    <GradientStop Color="SeaGreen" Offset="0.666" />
                    <GradientStop Color="MediumBlue" Offset="0.667" />
                    <GradientStop Color="MediumBlue" Offset="0.832" />
                    <GradientStop Color="Indigo" Offset="0.833" />
                    <GradientStop Color="Indigo" Offset="1.000" />
                </LinearGradientBrush>
            </Border.Background>
        </Border>

        <Border 
            x:Name="PageImageBackgroundBorder"
            Grid.Row="1">
            <Image 
                Source="ms-appx:///Assets/Background/mhellmeier_blue-hills.jpg"
                Stretch="UniformToFill" />
        </Border>

        <Grid x:Name="MasterGrid" Grid.Row="1">
            <Border 
                    Background="{ThemeResource TranslucentBackgroundMediumBrush}">
                <Border>
                    <!--<Border.Background>
                        <AcrylicBrush 
                            AlwaysUseFallback="False" 
                            TintColor="Black" 
                            TintOpacity="0.8" />
                    </Border.Background>-->
                    </Border>
            </Border>
            <ScrollViewer VerticalScrollMode="Auto" Margin="10,20,10,0">
                <StackPanel>
                    <TextBlock
                        TextWrapping="Wrap" 
                        x:Uid="NewDatafileContentDialogCreateInfo" />
                    <TextBox 
                    x:Name="TB_LocalFolder" 
                    x:Uid="NewDatafileContentDialogLocalFolder" 
                    Text="{x:Bind ViewModel.DateFileName,Mode=TwoWay}" 
                    Header="~NewDatafileContentDialogLocalFolder.Header"
                    Margin="0,10,0,10">
                    </TextBox>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                            <ColumnDefinition  Width="auto"/>
                        </Grid.ColumnDefinitions>
                        <PasswordBox 
                        x:Name="PB_LocalPassword"
                        x:Uid="Password"
                        Header="~Password.Header" 
                        InputScope="Password"
                        Password="{x:Bind ViewModel.Password, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                        </PasswordBox>
                        <HyperlinkButton
                            Grid.Column="1"
                            Height="36"
                            Width="48"
                            Padding="4,4,4,4"
                            ToolTipService.ToolTip="{x:Bind strings:Resources.ToolTipShowHelp}"
                            Click="HLBTN_PasswordInfo"
                            VerticalAlignment="Bottom">
                            <FontIcon
                            FontSize="20"
                            Foreground="Red"
                            Glyph="&#xE946;"/>
                        </HyperlinkButton>
                    </Grid>
                    <PasswordBox 
                        x:Name="PB_LocalPasswordRepeat" 
                        x:Uid="PasswordRepeat"
                        Header="~PasswordRepeat.Header" 
                        InputScope="Password" 
                        Password="{x:Bind ViewModel.PasswordRepeat,Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                        Margin="0,5,0,12">
                    </PasswordBox>

                    <Border 
                        Margin="0,12" 
                        Background="{ThemeResource AppBarSeparatorForegroundThemeBrush}" 
                        Height="1" />

                    <TextBox 
                        Text="{x:Bind ViewModel.FolderPath,Mode=OneWay}" 
                        x:Uid="NewDatafileContentDialogPath"
                        IsEnabled="False"
                        IsReadOnly="True"
                        Header="~NewDatafileContentDialogPath.Header"
                        Margin="0,0,0,10"/>
                    <Button 
                        Command="{x:Bind ViewModel.ChangePathCommand}"
                        x:Uid="NewDatafileContentDialogChangePath"
                        Content="~NewDatafileContentDialogChangePath.Content"/>

                    <Border 
                        Margin="0,12" 
                        Background="{ThemeResource AppBarSeparatorForegroundThemeBrush}" 
                        Height="1" />
                    <Button 
                        Style="{StaticResource AccentButtonStyle}"
                        Command="{x:Bind ViewModel.SetAndCreateLocalDatafileCommand}"
                        IsEnabled="{x:Bind ViewModel.DatafileBTNActive, Mode=OneWay}"
                        x:Uid="NewDatafilePageCreateFileBTN"
                        Content="~NewDatafilePageCreateFileBTN.Content" 
                        HorizontalAlignment="Center"/>
                </StackPanel>
            </ScrollViewer>
            <ctwc:SwitchPresenter 
                TargetType="x:Boolean"
                Value="{x:Bind ViewModel.ShowError, Mode=OneWay}">
                <ctwc:Case Value="True">
                    <Grid
                        Background="{ThemeResource TranslucentBackgroundHighBrush}">
                        <StackPanel>
                            <AnimatedVisualPlayer 
                                MaxHeight="120"
                                x:Name="LottiePlayer" 
                                PlaybackRate="0.5"
                                AutoPlay="True">
                                <lottie:LottieVisualSource  
                        UriSource="ms-appx:///Assets/AnimatedVisuals/3932-error-cross.json"/>
                            </AnimatedVisualPlayer>
                            <TextBlock 
                        Text="{x:Bind ViewModel.ErrorText,Mode=OneWay}" 
                        TextWrapping="WrapWholeWords"/>
                            <Button 
                        Content="{x:Bind strings:Resources.Confirm}" 
                        Command="{x:Bind ViewModel.ConfirmErrorCommand}"
                        Style="{StaticResource AccentButtonStyle}"
                        HorizontalAlignment="Center"/>
                        </StackPanel>
                    </Grid>
                </ctwc:Case>
            </ctwc:SwitchPresenter>
        </Grid>

    </Grid>
</Page>
